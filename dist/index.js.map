{"version":3,"file":"index.js","mappings":"8BACA,IAAIA,EAAsB,CCA1BA,EAAwB,CAACC,EAASC,KACjC,IAAI,IAAIC,KAAOD,EACXF,EAAoBI,EAAEF,EAAYC,KAASH,EAAoBI,EAAEH,EAASE,IAC5EE,OAAOC,eAAeL,EAASE,EAAK,CAAEI,YAAY,EAAMC,IAAKN,EAAWC,IAE1E,ECNDH,EAAwB,CAACS,EAAKC,IAAUL,OAAOM,UAAUC,eAAeC,KAAKJ,EAAKC,I,sBCElF,MAAM,GAFEI,EAE+B,CAAE,QAAa,IAAMC,EAA0D,SAFnGC,EAAI,CAAC,EAAGhB,EAAoBiB,EAAED,EAAGF,GAAWE,GCMzDE,EAAaC,GACbC,MAAMC,QAAQF,GACR,GAA2BG,UAAUH,EAAII,IAAIL,IAGnDC,aAAeK,SAAWL,aAAeM,KACpCN,EAGE,MAAPA,GAAiBA,EAAeO,UAI7BC,EAAAA,EAAAA,SAAYR,EAAeO,YAHzB,KDhBHZ,MAAWE,ECyEnB,QA/CA,SAA0DY,KAAqCC,GAC7F,MAAMC,EAAWD,EAAKN,IAAIL,GAIpBa,EAAeD,EAASP,KAAI,CAACS,EAAGC,IAChCD,aAAaR,SAAWQ,aAAaP,KAC/B,0CAAyCQ,YAE/Cb,MAAMC,QAAQW,GACZA,EAAEE,OAAOC,GAAMA,aAAaX,SAAWW,aAAaV,OAC9C,0CAAyCQ,0CAE5CD,EAAET,KAAKa,GAASA,GAAQ,KAAIC,KAAK,IAEnCL,GAAK,KAGRM,EAAgBC,OAAOC,IAAIZ,KAAeG,GAC1CU,EAASC,SAASC,cAAc,OACtCF,EAAOG,UAAYN,EAAcO,OAEjCJ,EAAOK,iBAAiB,kBAAkBC,SAASC,IACjD,MAAMC,EAAKD,EACLE,EAAmBC,SAASF,EAAGG,QAAQC,OAAS,KAAM,IAC5D,IAA0B,IAAtBH,EACF,MAAM,IAAII,MAAM,wDAElB,GAAmC,UAA/BL,EAAGG,QAAQG,gBAA6B,CAC1C,MAAMC,EAAuBP,EAAGQ,cAChCR,EAAGS,SACD5B,EAASoB,GAAoCH,SAASf,IACtDwB,GAAsBG,YAAY3B,EAAE,GAExC,MACEiB,EAAGQ,eAAeG,aAAa9B,EAASoB,GAA8BD,EACxE,IAEF,MAAMY,EAAW,IAAIpB,EAAOqB,YAAYC,QACrC/C,GAAqB,UAAfA,EAAEgD,UAAyBhD,EAAEiD,aAAejD,EAAEiD,YAAYpB,OAAOqB,OAAS,IAEnF,OAAIzB,EAAO0B,YAAcN,EAASK,OAAS,EAClCL,EAEFpB,EAAO0B,UAChB,E","sources":["webpack://@joyned/html-fairy/webpack/bootstrap","webpack://@joyned/html-fairy/webpack/runtime/define property getters","webpack://@joyned/html-fairy/webpack/runtime/hasOwnProperty shorthand","webpack://@joyned/html-fairy/external module \"escape-html\"","webpack://@joyned/html-fairy/./src/index.ts"],"sourcesContent":["// The require scope\nvar __webpack_require__ = {};\n\n","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","var x = y => { var x = {}; __webpack_require__.d(x, y); return x; }\nvar y = x => () => x\nconst __WEBPACK_NAMESPACE_OBJECT__ = x({ [\"default\"]: () => __WEBPACK_EXTERNAL_MODULE_escape_html_1f5254f1__[\"default\"] });","import escapeHtml from 'escape-html'\n\ntype ElementOrText = Element | Text | Element[] | Text[]\n\ntype SafeArgument = Element | Text | null | undefined | string\n\nconst escapeArg = (arg: unknown): SafeArgument | Array<SafeArgument> => {\n  if (Array.isArray(arg)) {\n    return ([] as Array<SafeArgument>).concat(...arg.map(escapeArg))\n  }\n\n  if (arg instanceof Element || arg instanceof Text) {\n    return arg\n  }\n\n  if (arg == null || !(arg as object).toString) {\n    return null\n  }\n\n  return escapeHtml((arg as object).toString())\n}\n\n/**\n * Returns an HTML structure build from the given `htmlString`. If any argument is a HTMLElement\n * The original element will be used and will be nested in the correct nested place.\n */\nfunction htmlFairy<T extends ElementOrText = HTMLElement>(htmlString: TemplateStringsArray, ...args: unknown[]): T {\n  const safeArgs = args.map(escapeArg)\n\n  // Replace every html element argument with a placeholder. After the creation, the original\n  // element will be put back in place instead of the the placeholder.\n  const templateArgs = safeArgs.map((e, i) => {\n    if (e instanceof Element || e instanceof Text) {\n      return `<div class=\"html-fairy-ph\" data-index=\"${i}\"></div>`\n    }\n    if (Array.isArray(e)) {\n      if (e.every((v) => v instanceof Element || v instanceof Text)) {\n        return `<div class=\"html-fairy-ph\" data-index=\"${i}\" data-placeholder-type=\"array\"></div>`\n      }\n      return e.map((text) => text ?? '').join('')\n    }\n    return e ?? ''\n  })\n\n  const htmlStringRaw = String.raw(htmlString, ...templateArgs)\n  const parsed = document.createElement('div')\n  parsed.innerHTML = htmlStringRaw.trim()\n\n  parsed.querySelectorAll('.html-fairy-ph').forEach((element) => {\n    const el = element as HTMLElement\n    const originalArgIndex = parseInt(el.dataset.index ?? '-1', 10)\n    if (originalArgIndex === -1) {\n      throw new Error('html-fairy placeholder is defined with no data index')\n    }\n    if (el.dataset.placeholderType === 'array') {\n      const placeholderContainer = el.parentElement\n      el.remove()\n      ;(safeArgs[originalArgIndex] as HTMLElement[]).forEach((e) => {\n        placeholderContainer?.appendChild(e)\n      })\n    } else {\n      el.parentElement?.replaceChild(safeArgs[originalArgIndex] as Element, el)\n    }\n  })\n  const children = [...parsed.childNodes].filter(\n    (x) => x.nodeName !== '#text' || (x.textContent && x.textContent.trim().length > 0)\n  )\n  if (parsed.firstChild && children.length > 1) {\n    return children as T\n  }\n  return parsed.firstChild as T\n}\n\nexport default htmlFairy\n"],"names":["__webpack_require__","exports","definition","key","o","Object","defineProperty","enumerable","get","obj","prop","prototype","hasOwnProperty","call","y","__WEBPACK_EXTERNAL_MODULE_escape_html_1f5254f1__","x","d","escapeArg","arg","Array","isArray","concat","map","Element","Text","toString","escapeHtml","htmlString","args","safeArgs","templateArgs","e","i","every","v","text","join","htmlStringRaw","String","raw","parsed","document","createElement","innerHTML","trim","querySelectorAll","forEach","element","el","originalArgIndex","parseInt","dataset","index","Error","placeholderType","placeholderContainer","parentElement","remove","appendChild","replaceChild","children","childNodes","filter","nodeName","textContent","length","firstChild"],"sourceRoot":""}
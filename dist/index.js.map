{"version":3,"file":"index.js","mappings":"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","sources":["webpack://@joyned/html-fairy/./node_modules/escape-html/index.js","webpack://@joyned/html-fairy/webpack/bootstrap","webpack://@joyned/html-fairy/webpack/runtime/compat get default export","webpack://@joyned/html-fairy/webpack/runtime/define property getters","webpack://@joyned/html-fairy/webpack/runtime/hasOwnProperty shorthand","webpack://@joyned/html-fairy/./src/index.ts"],"sourcesContent":["/*!\n * escape-html\n * Copyright(c) 2012-2013 TJ Holowaychuk\n * Copyright(c) 2015 Andreas Lubbe\n * Copyright(c) 2015 Tiancheng \"Timothy\" Gu\n * MIT Licensed\n */\n\n'use strict';\n\n/**\n * Module variables.\n * @private\n */\n\nvar matchHtmlRegExp = /[\"'&<>]/;\n\n/**\n * Module exports.\n * @public\n */\n\nmodule.exports = escapeHtml;\n\n/**\n * Escape special characters in the given string of html.\n *\n * @param  {string} string The string to escape for inserting into HTML\n * @return {string}\n * @public\n */\n\nfunction escapeHtml(string) {\n  var str = '' + string;\n  var match = matchHtmlRegExp.exec(str);\n\n  if (!match) {\n    return str;\n  }\n\n  var escape;\n  var html = '';\n  var index = 0;\n  var lastIndex = 0;\n\n  for (index = match.index; index < str.length; index++) {\n    switch (str.charCodeAt(index)) {\n      case 34: // \"\n        escape = '&quot;';\n        break;\n      case 38: // &\n        escape = '&amp;';\n        break;\n      case 39: // '\n        escape = '&#39;';\n        break;\n      case 60: // <\n        escape = '&lt;';\n        break;\n      case 62: // >\n        escape = '&gt;';\n        break;\n      default:\n        continue;\n    }\n\n    if (lastIndex !== index) {\n      html += str.substring(lastIndex, index);\n    }\n\n    lastIndex = index + 1;\n    html += escape;\n  }\n\n  return lastIndex !== index\n    ? html + str.substring(lastIndex, index)\n    : html;\n}\n","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = (module) => {\n\tvar getter = module && module.__esModule ?\n\t\t() => (module['default']) :\n\t\t() => (module);\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","import escapeHtml from 'escape-html';\n\ntype ElementOrText = Element | Text | Element[] | Text[];\n\ntype SafeArgument = Element | Text | null | undefined | string\n\nconst escapeArg = (arg: unknown): SafeArgument | Array<SafeArgument> => {\n  if (Array.isArray(arg)) {\n    return ([] as Array<SafeArgument>).concat(...arg.map(escapeArg));\n  }\n\n  if (arg instanceof Element || arg instanceof Text) { return arg; }\n\n  if (arg == null || !(arg as object).toString) { return null; }\n\n  return escapeHtml((arg as object).toString());\n};\n\n/**\n * Returns an HTML structure build from the given `htmlString`. If any argument is a HTMLElement\n * The original element will be used and will be nested in the correct nested place.\n */\nconst htmlFairy = <T extends ElementOrText = HTMLElement>(\n  htmlString: TemplateStringsArray, ...args: unknown[]\n): T => {\n  const safeArgs = args.map(escapeArg);\n\n  // Replace every html element argument with a placeholder. After the creation, the original\n  // element will be put back in place instead of the the placeholder.\n  const templateArgs = safeArgs.map((e, i) => {\n    if (e instanceof Element || e instanceof Text) {\n      return `<div class=\"html-fairy-ph\" data-index=\"${i}\"></div>`;\n    }\n    if (Array.isArray(e)) {\n      if (e.every((v) => v instanceof Element || v instanceof Text)) {\n        return `<div class=\"html-fairy-ph\" data-index=\"${i}\" data-placeholder-type=\"array\"></div>`;\n      }\n      return e.map((text) => text ?? '').join('');\n    }\n    return e ?? '';\n  });\n\n  const htmlStringRaw = String.raw(htmlString, ...templateArgs);\n  const parsed = document.createElement('div');\n  parsed.innerHTML = htmlStringRaw.trim();\n\n  parsed.querySelectorAll('.html-fairy-ph').forEach((element) => {\n    const originalArgIndex = Number.parseInt(element.getAttribute('data-index') ?? '-1', 10);\n    if (originalArgIndex === -1) {\n      throw new Error('html-fairy placeholder is defined with no data index');\n    }\n    if (element.getAttribute('data-placeholder-type') === 'array') {\n      const placeholderContainer = element.parentElement;\n      element.remove();\n      (safeArgs[originalArgIndex] as HTMLElement[]).forEach((e) => {\n        placeholderContainer?.appendChild(e);\n      });\n    } else {\n      element.parentElement?.replaceChild(safeArgs[originalArgIndex] as Element, element);\n    }\n  });\n  const children = Array.from(parsed.childNodes)\n    .filter((x) => x.nodeName !== '#text' || (x.textContent && x.textContent.trim().length > 0));\n  if (parsed.firstChild && children.length > 1) {\n    return children as T;\n  }\n  return parsed.firstChild as T;\n};\n\nexport default htmlFairy;\n"],"names":["matchHtmlRegExp","module","exports","string","escape","str","match","exec","html","index","lastIndex","length","charCodeAt","substring","__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","undefined","__webpack_modules__","n","getter","__esModule","d","a","definition","key","o","Object","defineProperty","enumerable","get","obj","prop","prototype","hasOwnProperty","call","escapeArg","arg","Array","isArray","concat","map","Element","Text","toString","escapeHtml","htmlString","args","safeArgs","templateArgs","e","i","every","v","text","join","htmlStringRaw","String","raw","parsed","document","createElement","innerHTML","trim","querySelectorAll","forEach","element","originalArgIndex","Number","parseInt","getAttribute","Error","placeholderContainer","parentElement","remove","appendChild","replaceChild","children","from","childNodes","filter","x","nodeName","textContent","firstChild"],"sourceRoot":""}